# AnkAi Caddyfile - Reverse Proxy with Auto-HTTPS
#
# Usage:
# 1. With a domain (recommended): Replace "your-domain.com" with your actual domain
#    Caddy will automatically obtain SSL certificates from Let's Encrypt
#
# 2. Without a domain: Comment out the domain block and uncomment the :80 block below
#    This will serve over HTTP only (no HTTPS)
#
# After editing, restart Caddy: docker compose -f docker-compose.prod.yml restart caddy

# Option 1: With a domain (auto-HTTPS)
# Uncomment and edit the domain below:
#
# your-domain.com {
#     # API routes
#     handle /api/* {
#         reverse_proxy backend:8000
#     }
#
#     # Frontend (catch-all)
#     handle {
#         reverse_proxy frontend:80
#     }
# }

# Option 2: Without a domain (HTTP only on port 80)
# This is the default - works with just the VM's public IP
:80 {
    # API routes
    handle /api/* {
        reverse_proxy backend:8000
    }

    # Frontend (catch-all)
    handle {
        reverse_proxy frontend:80
    }
}
